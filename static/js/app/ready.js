// Generated by CoffeeScript 1.6.3
define(['jquery', 'app/floyd'], function($, floyd) {
  var animatedDither, dither, inputCanvas, inputCtx, loadImage, outputCanvas, outputCtx, quantize, s, src;
  animatedDither = floyd.animatedDither, dither = floyd.dither, loadImage = floyd.loadImage, quantize = floyd.quantize;
  inputCanvas = $('#input')[0];
  outputCanvas = $('#output')[0];
  inputCtx = inputCanvas.getContext('2d');
  outputCtx = outputCanvas.getContext('2d');
  if (location.hash) {
    s = location.hash.slice(1);
    src = "img/" + s;
  } else {
    src = 'img/cooldog.jpg';
  }
  $('#process').click(function() {
    var bits, delay, height, imageData, method, putImageData, width, _ref;
    _ref = inputCtx.canvas, width = _ref.width, height = _ref.height;
    imageData = inputCtx.getImageData(0, 0, width, height);
    bits = Number($('#bitSlider').val());
    putImageData = function(imageData) {
      outputCtx.canvas.width = inputCtx.canvas.width;
      outputCtx.canvas.height = inputCtx.canvas.height;
      return outputCtx.putImageData(imageData, 0, 0);
    };
    method = $('#method').val();
    switch (method) {
      case 'Quantize':
        imageData = quantize(imageData, bits);
        return putImageData(imageData);
      case 'Dither':
        imageData = dither(imageData, bits);
        return putImageData(imageData);
      case 'AnimatedDither':
        delay = Number($('#delaySlider').val());
        putImageData(imageData);
        return animatedDither(outputCtx, bits, delay);
    }
  });
  loadImage(inputCtx, src);
  $('#bitSlider').change(function() {
    return $('#bits').html((Number(this.value)) * 3);
  });
  $('#delaySlider').change(function() {
    return $('#delay').html(Number(this.value));
  });
  return alert('qwerty!');
});
